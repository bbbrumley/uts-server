matrix:
  include:
    - os: linux
      dist: trusty

sudo: false

before_install:
  - ./tests/cfg/pki/create_tsa_certs
  - if [[ "$TRAVIS_OS_NAME" == "osx" ]]; then xcode-select --install; fi
  - if [[ "$TRAVIS_OS_NAME" == "osx" ]]; then brew update  ; fi
  - if [[ "$TRAVIS_OS_NAME" == "osx" ]]; then brew install argp-standalone; fi
  - if [[ "$TRAVIS_OS_NAME" == "osx" ]]; then brew install valgrind; fi
  - if [[ "$TRAVIS_OS_NAME" == "osx" ]]; then brew install libxml2; fi
  - if [[ "$TRAVIS_OS_NAME" == "osx" ]]; then brew install coreutils; fi

addons:
  apt:
    packages:
      - cmake
      - time
      - valgrind
      - libxml2-utils
      - libc6-dev
      - gcc
      - g++
      - libssl-dev
    sources:
      - kubuntu-backports

language: c

compiler: clang

script: cmake . -DBUNDLE_CIVETWEB=ON && make && ./tests/external_test.sh
